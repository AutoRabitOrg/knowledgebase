# Polyfill.io Vulnerability Rules

As of June 26th, 2024, Salesforce released [a security notice warning of vulnerabilities in polyfill.io’s javascript library](https://status.salesforce.com/generalmessages/1391).  CodeScan has released rules to find any uses of this library in your Salesforce Org.&#x20;

There are 2 new rules that you can enable for your quality profiles:&#x20;

* Avoid Script References to polyfill.io \
  This rule checks your Lightning components and Visualforce pages for references to polyfill.io and their CDN. \

* Avoid Configuration Refences to polyfill.io \
  This rule checks your Content Security Policies, Cross Origin Sharing settings and Remote Site Settings in Salesforcemetadata for references and whitelisting of polyfill.io&#x20;

&#x20;To ensure that your projects are scanning with these rules, refer to the following steps:&#x20;

**Note**: If you are scanning from Salesforce directly using CodeScan’s built in Salesforce integration, start with step 1.  Otherwise, skip to step 2.&#x20;

1. **Add the metadate types for download:**\
   In the Project Settings > General Settings menu, scroll down to CodeScan Cloud Download Types:

<figure><img src="../../../.gitbook/assets/Screenshot 2024-07-10 at 10.39.37 AM.png" alt="" width="563"><figcaption></figcaption></figure>

Add three lines: CspTrustedSite, CorsWhitelistOrigin, and RemoteSiteSetting

<figure><img src="../../../.gitbook/assets/Screenshot 2024-07-10 at 10.39.54 AM.png" alt="" width="563"><figcaption></figcaption></figure>

**Save** your changes

2. **Add the metadata file suffixes:**\
   On the same page, scroll down to Metadata File Suffixes:

<figure><img src="../../../.gitbook/assets/Screenshot 2024-07-10 at 10.40.15 AM.png" alt="" width="563"><figcaption></figcaption></figure>

Add three lines: cspTrustedSite, corswhitelistorigin, and remoteSite

**NOTE: If your project is in Source format (SF CLI), you will need to add cspTrustedSite-meta.xml, corsWhitelistOrigin-meta.xml, and remoteSite-meta.xml instead.**

<figure><img src="../../../.gitbook/assets/Screenshot 2024-07-10 at 10.40.30 AM.png" alt="" width="563"><figcaption></figcaption></figure>

**Save** your changes&#x20;

3. **Add the rules to your Quality Profile:** \
   Add the rules to your custom quality profile as outlined in our [Customizing Quality Profiles](https://knowledgebase.autorabit.com/product-guides/codescan/quality-profiles/customizing-quality-profiles) article.&#x20;

&#x20;You’re ready to go!  Run your project analysis and if any references to polyfill.io are found, a violation will be thrown on that configuration file, page or component.&#x20;

